---
title: "abundance-nasa1"
output: html_document
date: "2025-08-20"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

```{r}
library(readr)
SWD_data <- read_csv("C:/Users/maria/OneDrive/Desktop/abundance-nasa/NEW CLEAN EXCEL Nunez SWD Sorting Sheet June 2024 for abundance-nasa(Data).csv")
```

```{r}
library(nasapower)
library(tidyverse)
library(magrittr)
library(ggplot2)
```

```{r}
SweetRoots_weather <- get_power(# choose name; get_power is function from nasapower package
  # i think
  community = "ag",
  lonlat = c(-73.2420434,44.2893745),# location of data
  pars = c("RH2M", "T2M", "PRECTOTCORR"),
  dates = c("2022-01-01", # dates of data
            paste(2025, "-08-20", sep = "")),
  temporal_api = "daily"# frequency of measurements
)
AdamsBerry_weather <- get_power(
  community = "ag",
  lonlat = c(-73.1885194,44.29804),
  pars = c("RH2M", "T2M", "PRECTOTCORR"),
  dates = c("2022-01-01", 
            paste(2025, "-08-20", sep = "")),
  temporal_api = "daily"
)
FullBelly_weather <- get_power(
  community = "ag",
  lonlat = c(-73.1334011,44.265172),
  pars = c("RH2M", "T2M", "PRECTOTCORR"),
  dates = c("2022-01-01", 
            paste(2025, "-08-20", sep = "")),
  temporal_api = "daily"
)
LastResort_weather <- get_power(
  community = "ag",
  lonlat = c(-73.1014259,44.2661258),
  pars = c("RH2M", "T2M", "PRECTOTCORR"),
  dates = c("2022-01-01", 
            paste(2025, "-08-20", sep = "")),
  temporal_api = "daily"
)
CoveredBridge_weather <- get_power(
  community = "ag",
  lonlat = c(-72.926916,44.5147926),
  pars = c("RH2M", "T2M", "PRECTOTCORR"),
  dates = c("2022-01-01", 
            paste(2025, "-08-20", sep = "")),
  temporal_api = "daily"
)
```

```{r}
LexingtonBluegrass_weather <- get_power(
  community = "ag",
  lonlat = c(-84.6058,38.0408),
  pars = c("RH2M", "T2M", "PRECTOTCORR"),
  dates = c("2020-01-01", 
            paste(2025, "-08-20", sep = "")),
  temporal_api = "daily"
)
CartersMountain_weather <- get_power(
  community = "ag",
  lonlat = c(-78.5447915,37.9740223),
  pars = c("RH2M", "T2M", "PRECTOTCORR"),
  dates = c("2017-01-01", 
            paste(2025, "-08-20", sep = "")),
  temporal_api = "daily"
)
ChilesPeachOrchard_weather <- get_power(
  community = "ag",
  lonlat = c(-78.7471497,38.0672129),
  pars = c("RH2M", "T2M", "PRECTOTCORR"),
  dates = c("2022-01-01", 
            paste(2025, "-08-20", sep = "")),
  temporal_api = "daily"
)
LeveringOrchard_weather <- get_power(
  community = "ag",
  lonlat = c(-80.6151617,36.6500994),
  pars = c("RH2M", "T2M", "PRECTOTCORR"),
  dates = c("2022-01-01", 
            paste(2025, "-08-20", sep = "")),
  temporal_api = "daily"
)
CharlottesvilleAlbermarle_weather <- get_power(
  community = "ag",
  lonlat = c(-78.4638626,38.0624585),
  pars = c("RH2M", "T2M", "PRECTOTCORR"),
  dates = c("2022-01-01", 
            paste(2025, "-08-20", sep = "")),
  temporal_api = "daily"
)
GreatCountryFarms_weather <- get_power(
  community = "ag",
  lonlat = c(-77.8162521,39.1003535),
  pars = c("RH2M", "T2M", "PRECTOTCORR"),
  dates = c("2022-01-01", 
            paste(2025, "-08-20", sep = "")),
  temporal_api = "daily"
)
CrossKeysFarm_weather <- get_power(
  community = "ag",
  lonlat = c(-78.842056,38.3597327),
  pars = c("RH2M", "T2M", "PRECTOTCORR"),
  dates = c("2022-01-01", 
            paste(2025, "-08-20", sep = "")),
  temporal_api = "daily"
)
```

```{r}
AlBe_weather <- get_power(
  community = "ag",
  lonlat = c(-79.081904,38.146223),
  pars = c("RH2M", "T2M", "PRECTOTCORR"),
  dates = c("2021-01-01", 
            paste(2025, "-08-20", sep = "")),
  temporal_api = "daily"
)
KiBa_weather <- get_power(
  community = "ag",
  lonlat = c(-79.017840,37.8929361),
  pars = c("RH2M", "T2M", "PRECTOTCORR"),
  dates = c("2021-01-01", 
            paste(2025, "-08-20", sep = "")),
  temporal_api = "daily"
)
JoNu_weather <- get_power(
  community = "ag",
  lonlat = c(-78.488982,38.0783378),
  pars = c("RH2M", "T2M", "PRECTOTCORR"),
  dates = c("2021-01-01", 
            paste(2025, "-08-20", sep = "")),
  temporal_api = "daily"
)
FeAb_weather <- get_power(
  community = "ag",
  lonlat = c(-78.48961,37.97985),
  pars = c("RH2M", "T2M", "PRECTOTCORR"),
  dates = c("2021-01-01", 
            paste(2025, "-08-20", sep = "")),
  temporal_api = "daily"
)
RaPo_weather <- get_power(
  community = "ag",
  lonlat = c(-78.3417122,37.9778276),
  pars = c("RH2M", "T2M", "PRECTOTCORR"),
  dates = c("2021-01-01", 
            paste(2025, "-08-20", sep = "")),
  temporal_api = "daily"
)
WiHa_weather <- get_power(
  community = "ag",
  lonlat = c(-78.631458,38.021608),
  pars = c("RH2M", "T2M", "PRECTOTCORR"),
  dates = c("2021-01-01", 
            paste(2025, "-08-20", sep = "")),
  temporal_api = "daily"
)
NoSh_weather <- get_power(
  community = "ag",
  lonlat = c(-78.631460,38.021608),
  pars = c("RH2M", "T2M", "PRECTOTCORR"),
  dates = c("2021-01-01", 
            paste(2025, "-08-20", sep = "")),
  temporal_api = "daily"
)
LiBl_weather <- get_power(
  community = "ag",
  lonlat = c(-78.4915567,38.0980496),
  pars = c("RH2M", "T2M", "PRECTOTCORR"),
  dates = c("2021-01-01", 
            paste(2025, "-08-20", sep = "")),
  temporal_api = "daily"
)
GwMe_weather <- get_power(
  community = "ag",
  lonlat = c(-77.49892,39.0444765),
  pars = c("RH2M", "T2M", "PRECTOTCORR"),
  dates = c("2021-01-01", 
            paste(2025, "-08-20", sep = "")),
  temporal_api = "daily"
)
FrSa_weather <- get_power(
  community = "ag",
  lonlat = c(-78.8319075,38.3967029),
  pars = c("RH2M", "T2M", "PRECTOTCORR"),
  dates = c("2021-01-01", 
            paste(2025, "-08-20", sep = "")),
  temporal_api = "daily"
)
AlBe_weather <- get_power(
  community = "ag",
  lonlat = c(-79.081904,38.146223),
  pars = c("RH2M", "T2M", "PRECTOTCORR"),
  dates = c("2021-01-01", 
            paste(2025, "-08-20", sep = "")),
  temporal_api = "daily"
)
NaMo_weather <- get_power(
  community = "ag",
  lonlat = c(-78.5021388,38.0653651),
  pars = c("RH2M", "T2M", "PRECTOTCORR"),
  dates = c("2021-01-01", 
            paste(2025, "-08-20", sep = "")),
  temporal_api = "daily"
)
AlBr_weather <- get_power(
  community = "ag",
  lonlat = c(-78.465637,38.036324),
  pars = c("RH2M", "T2M", "PRECTOTCORR"),
  dates = c("2021-01-01", 
            paste(2025, "-08-20", sep = "")),
  temporal_api = "daily"
)
SiKi_weather <- get_power(
  community = "ag",
  lonlat = c(-78.42491,38.291869),
  pars = c("RH2M", "T2M", "PRECTOTCORR"),
  dates = c("2021-01-01", 
            paste(2025, "-08-20", sep = "")),
  temporal_api = "daily"
)
LiHa_weather <- get_power(
  community = "ag",
  lonlat = c(-77.45722,37.5825066),
  pars = c("RH2M", "T2M", "PRECTOTCORR"),
  dates = c("2021-01-01", 
            paste(2025, "-08-20", sep = "")),
  temporal_api = "daily"
)
DoSc_weather <- get_power(
  community = "ag",
  lonlat = c(-78.473266,38.06808),
  pars = c("RH2M", "T2M", "PRECTOTCORR"),
  dates = c("2021-01-01", 
            paste(2025, "-08-20", sep = "")),
  temporal_api = "daily"
)
NaCa_weather <- get_power(
  community = "ag",
  lonlat = c(-79.5244928,36.608054),
  pars = c("RH2M", "T2M", "PRECTOTCORR"),
  dates = c("2021-01-01", 
            paste(2025, "-08-20", sep = "")),
  temporal_api = "daily"
)
```

```{r}
#Combine dataframes from all farms in VT
AllFarmsVT_weather <-rbind(AdamsBerry_weather, CoveredBridge_weather, FullBelly_weather, LastResort_weather, SweetRoots_weather)
#Combine dataframes from all farms in KY
AllFarmsKY_weather <-rbind(LexingtonBluegrass_weather, CrossKeysFarm_weather, CartersMountain_weather, GreatCountryFarms_weather, LeveringOrchard_weather, CharlottesvilleAlbermarle_weather,ChilesPeachOrchard_weather)
#Combine dataframes from all farms in VA
AllFarmsVA_weather <-rbind(AlBe_weather,KiBa_weather,JoNu_weather,FeAb_weather,RaPo_weather,WiHa_weather,NoSh_weather,LiBl_weather,GwMe_weather,FrSa_weather,NaMo_weather,AlBr_weather,SiKi_weather,LiHa_weather,DoSc_weather,NaCa_weather)
#Combine dataframes for all farms 
AllFarmsTotal_weather<-rbind.data.frame(AllFarmsKY_weather, AllFarmsVT_weather, AllFarmsVA_weather)
```

```{r}
#CombineLatLon data into one variable "Coordinates".
AllFarmsVT_weather$Coordinates<- paste(AllFarmsVT_weather$LAT, AllFarmsVT_weather$LON,sep=",")
AllFarmsKY_weather$Coordinates<- paste(AllFarmsKY_weather$LAT, AllFarmsKY_weather$LON,sep=",")
AllFarmsVA_weather$Coordinates<- paste(AllFarmsVA_weather$LAT, AllFarmsVA_weather$LON,sep=",")
AllFarmsTotal_weather$Coordinates<- paste(AllFarmsTotal_weather$LAT, AllFarmsTotal_weather$LON,sep=",")
```

```{r}
AllFarmsVT_weather$DD<-NULL
AllFarmsVT_weather$DOY<-NULL
AllFarmsKY_weather$DD<-NULL
AllFarmsKY_weather$DOY<-NULL
AllFarmsVA_weather$DD<-NULL
AllFarmsVA_weather$DOY<-NULL
AllFarmsTotal_weather$DD<-NULL
AllFarmsTotal_weather$DOY<-NULL
#save YYYYMMDD as a date 
AllFarmsTotal_weather$YYYYMMDD <- as.Date(AllFarmsTotal_weather$YYYYMMDD, format = "%Y-%m-%d")
AllFarmsVA_weather$YYYYMMDD <- as.Date(AllFarmsVA_weather$YYYYMMDD, format = "%Y-%m-%d")
AllFarmsKY_weather$YYYYMMDD <- as.Date(AllFarmsKY_weather$YYYYMMDD, format = "%Y-%m-%d")
AllFarmsVT_weather$YYYYMMDD <- as.Date(AllFarmsVT_weather$YYYYMMDD, format = "%Y-%m-%d")
SWD_data$YYYYMMDD <-as.Date(SWD_data$YYYYMMDD, format = "%Y-%m-%d")
```

```{r}
AbundanceTempVT<-right_join(SWD_data, AllFarmsVT_weather, by = c("Coordinates","YYYYMMDD"))
AbundanceTempKY<-right_join(SWD_data, AllFarmsKY_weather, by = c("YYYYMMDD","Coordinates"))
AbundanceTempVA<-right_join(SWD_data, AllFarmsVA_weather, by = c("Coordinates","YYYYMMDD"))
AbundanceTempTotal<-right_join(SWD_data, AllFarmsTotal_weather, by = c("Coordinates","YYYYMMDD"))
```

```{r}
#Ensure that variables are factor columns, rather than numeric.
AbundanceTempVT$T2M <- as.numeric(as.character(AbundanceTempVT$T2M))
AbundanceTempVT$N_swd<-as.numeric(as.character(AbundanceTempVT$N_swd))
AbundanceTempKY$T2M <- as.numeric(as.character(AbundanceTempKY$T2M))
AbundanceTempKY$N_swd<-as.numeric(as.character(AbundanceTempKY$N_swd))
AbundanceTempVA$T2M <- as.numeric(as.character(AbundanceTempVA$T2M))
AbundanceTempVA$N_swd<-as.numeric(as.character(AbundanceTempVA$N_swd))
AbundanceTempTotal$T2M <- as.numeric(as.character(AbundanceTempTotal$T2M))
AbundanceTempTotal$N_swd<-as.numeric(as.character(AbundanceTempTotal$N_swd))
```

```{r}
#Create a subset of the SWD data for just VT
SWD_dataVT<-SWD_data %>% 
    dplyr::filter(Coordinates %in% c("44.5147926,-72.926916", "44.265172,-73.1334011", "44.2661258,-73.1014259", "44.2893745,-73.2420434", "44.29804,-73.1885194"))
#Create a subset of the SWD data for just VA
SWD_dataVA<-SWD_data %>% 
    dplyr::filter(Coordinates %in% c("38.0408,-84.6058","37.9740223,-78.5447915","38.0672129,-78.7471497","38.0624585,-78.4638626","36.6500994,-80.6151617","39.1003535,-77.8162521","38.3597327,-78.842056"))
#Create a subset of the SWD data for just KY
SWD_dataKY<-SWD_data %>% 
    dplyr::filter(Coordinates %in% c("38.146223,-79.081904","37.8929361,-79.0178402","38.0783378,-78.488982","37.97985,-78.48961","37.9778276,-78.3417122","38.021608,-78.631458","38.3563214,-78.9565994","38.0980496,-78.4915567","39.0444765,-77.49892","38.3967029,-78.8319075","38.0653651,-78.5021388","38.036324,-78.465637","38.291869,-78.42491","37.5825066,-77.45722","38.06808,-78.473266","36.608054,-79.5244928","38.0783378,-78.488982"))

#Create a subset of the SWD data for just the 6 farms of interest 
SWD_dataFBF<-AbundanceTempVT %>% 
    dplyr::filter(Coordinates %in% c("44.265172,-73.1334011"))
SWD_dataABF<-AbundanceTempVT %>% 
    dplyr::filter(Coordinates %in% c("44.29804,-73.1885194"))
SWD_dataCM<-AbundanceTempKY %>% 
    dplyr::filter(Coordinates %in% c("37.9740223,-78.5447915"))
SWD_dataLBA<-AbundanceTempKY %>% 
    dplyr::filter(Coordinates %in% c("38.0408,-84.6058"))
SWD_dataAlBe<-AbundanceTempVA %>% 
    dplyr::filter(Coordinates %in% c("38.146223,-79.081904"))
SWD_dataFrSa<-AbundanceTempVA %>% 
    dplyr::filter(Coordinates %in% c("38.3967029,-78.8319075"))
```

```{r}
#create a scatter plot of PRECTOTCORR against SWD for VT
attach(AbundanceTempVT)
plot(PRECTOTCORR,N_swd,
     ylab = "Number of SWD Males",
     xlab = "Average total precipitation at surface of Earth",
     main = " VT Precipitation vs SWD Population",
     pch = 21,
     bg = "darkgreen",
     col = "darkgreen",
)
#create a scatter plot of T2M against SWD
attach(AbundanceTempVT)
plot(T2M,N_swd,
     ylab = "Number of SWD Males",
     xlab = "Tempature (degrees C)",
     main = "VT Temperature vs SWD Population",
     pch = 21,
     bg = "darkgreen",
     col = "darkgreen",
)
#create a scatter plot of RH2M against SWD
attach(AbundanceTempVT)
plot(RH2M,N_swd,
     ylab = "Number of SWD Males",
     xlab = "Relative Humidity",
     main = "VT Relative Humidity vs SWD Population",
     pch = 21,
     bg = "darkgreen",
     col = "darkgreen",
)
```

```{r}
#create a scatter plot of PRECTOTCORR against SWD for KY
attach(AbundanceTempKY)
plot(PRECTOTCORR,N_swd,
     ylab = "Number of SWD Males",
     xlab = "Average total precipitation at surface of Earth",
     main = "KY Precipitation vs SWD Population",
     pch = 21,
     bg = "darkred",
     col = "darkred",
)
#create a scatter plot of T2M against SWD
attach(AbundanceTempKY)
plot(T2M,N_swd,
     ylab = "Number of SWD Males",
     xlab = "Tempature (degrees C)",
     main = "KY Temperature vs SWD Population",
     pch = 21,
     bg = "darkred",
     col = "darkred",
)
#create a scatter plot of RH2M against SWD
attach(AbundanceTempKY)
plot(RH2M,N_swd,
     ylab = "Number of SWD Males",
     xlab = "Relative Humidity",
     main = "KY Relative Humidity vs SWD Population",
     pch = 21,
     bg = "darkred",
     col = "darkred",
)
```

```{r}
#create a scatter plot of PRECTOTCORR against SWD for KY
attach(AbundanceTempVA)
plot(PRECTOTCORR,N_swd,
     ylab = "Number of SWD Males",
     xlab = "Average total precipitation at surface of Earth",
     main = "VA Precipitation vs SWD Population",
     pch = 21,
     bg = "orange",
     col = "orange",
)
#create a scatter plot of T2M against SWD
attach(AbundanceTempVA)
plot(T2M, N_swd,
     ylab = "Number of SWD Males",
     xlab = "Tempature (degrees C)",
     main = "VA Temperature vs SWD Population",
     pch = 21,
     bg = "orange",
     col = "orange",
)
#create a scatter plot of RH2M against SWD
attach(AbundanceTempVA)
plot(RH2M,N_swd,
     ylab = "Number of SWD Males",
     xlab = "Relative Humidity",
     main = "VA Relative Humidity vs SWD Population",
     pch = 21,
     bg = "orange",
     col = "orange",
)
```

```{r}
#create a scatter plot of PRECTOTCORR against SWD for All Farms 
attach(AbundanceTempTotal)
plot(PRECTOTCORR, N_swd,
     ylab = "Number of SWD Males",
     xlab = "Average total precipitation at surface of Earth",
     main = "Precipitation vs SWD Population",
     pch = 21,
     bg = "salmon",
     col = "salmon",
)
#create a scatter plot of T2M against SWD
attach(AbundanceTempTotal)
plot(T2M, N_swd,
     ylab = "Number of SWD Males",
     xlab = "Tempature (degrees C)",
     main = "Temperature vs SWD Population",
     pch = 21,
     bg = "salmon",
     col = "salmon",
)
#create a scatter plot of RH2M against SWD
attach(AbundanceTempTotal)
plot(RH2M, N_swd,
     ylab = "Number of SWD Males",
     xlab = "Relative Humidity",
     main = "Relative Humidity vs SWD Population",
     pch = 21,
     bg = "salmon",
     col = "salmon",
)
```

```{r}
coeff <-10
library(ggplot2)
#make a ggplot line chart to plot population over time
#NEED TO FIGURE OUT HOW TO REMOVE OUTLIER
ggplot(AbundanceTempTotal, aes(x = YYYYMMDD, y = N_swd)) +
  geom_line() +
  labs(title = "Population Over Time", x = "Year", y = "Population Count") +
  theme_minimal()
```


AbundanceAllTempVT<-right_join(SWD_data, AllFarmsVT_weather, by = c("Coordinates","YYYYMMDD"))
AbundanceAllTempKY<-right_join(SWD_data, AllFarmsKY_weather, by = c("YYYYMMDD","Coordinates"))
AbundanceAllTempVA<-right_join(SWD_data, AllFarmsVA_weather, by = c("Coordinates","YYYYMMDD"))
AbundanceAllTempTotal<-right_join(SWD_data, AllFarmsTotal_weather, by = c("Coordinates","YYYYMMDD"))


```{r}
#Create a plot with both temp and abundance data for specific farms
install.packages("gridExtra")
library(ggplot2)
library(gridExtra)
#FULL BELLY FARM
SWDPlotFBF<-ggplot(data = SWD_dataFBF, aes(x = YYYYMMDD, y = N_swd)) +
  geom_point(color = "orange", size = 1.5, shape =16, alpha = 0.7) +
  labs(title = "Full Belly Farm SWD Count Over Time", x = "Time", y = "Population Count") +
  theme_minimal()
T2MPlotFBF <- ggplot(SWD_dataFBF, aes(x=YYYYMMDD, y=T2M)) +
  geom_line(color = "lightblue") +
  labs(title = "Full Belly Farm Temperature Over Time", x = "Time", y = "Temperature (C)") +
  theme_minimal()
# Stack plots vertically using patchwork
grid.arrange(SWDPlotFBF, T2MPlotFBF, nrow = 2)

#ABF
SWDPlotABF<-ggplot(data = SWD_dataABF, aes(x = YYYYMMDD, y = N_swd)) +
  geom_point(color = "orange", size = 1.5, shape =16, alpha = 0.7) +
  labs(title = "Adam's Berry Farm SWD Count Over Time", x = "Time", y = "Population Count") +
  theme_minimal()
T2MPlotABF <- ggplot(SWD_dataFBF, aes(x=YYYYMMDD, y=T2M)) +
  geom_line(color = "lightblue") +
  labs(title = "Adam's Berry Farm Temperature Over Time", x = "Time", y = "Temperature(C)") +
  theme_minimal()
# Stack plots vertically using patchwork
grid.arrange(SWDPlotABF, T2MPlotABF, nrow = 2)

#CM
SWDPlotCM<-ggplot(data = SWD_dataCM, aes(x = YYYYMMDD, y = N_swd)) +
  geom_point(color = "orange", size = 1.5, shape =16, alpha = 0.7) +
  labs(title = "Carter's Mountain SWD Count Over Time", x = "Time", y = "Population Count") +
  theme_minimal()
T2MPlotCM <- ggplot(SWD_dataCM, aes(x=YYYYMMDD, y=T2M)) +
  geom_line(color = "lightblue") +
  labs(title = "Carter's Mountain Temperature Over Time", x = "Time", y = "Temperature (C)") +
  theme_minimal()
# Stack plots vertically using patchwork
grid.arrange(SWDPlotCM, T2MPlotCM, nrow = 2)

#LBA
SWDPlotLBA<-ggplot(data = SWD_dataLBA, aes(x = YYYYMMDD, y = N_swd)) +
  geom_point(color = "orange", size = 1.5, shape =16, alpha = 0.7) +
  labs(title = "Lexington Bluegrass Airport SWD Count Over Time", x = "Time", y = "Population Count") +
  theme_minimal()
T2MPlotLBA <- ggplot(SWD_dataLBA, aes(x=YYYYMMDD, y=T2M)) +
  geom_line(color = "lightblue") +
  labs(title = "Lexington Bluegrass Airport Temperature Over Time", x = "Time", y = "Temperature (C)") +
  theme_minimal()
# Stack plots vertically using patchwork
grid.arrange(SWDPlotLBA, T2MPlotLBA, nrow = 2)

#AlBe
SWDPlotAlBe<-ggplot(data = SWD_dataAlBe, aes(x = YYYYMMDD, y = N_swd)) +
  geom_point(color = "orange", size = 1.5, shape =16, alpha = 0.7) +
  labs(title = "AlBe SWD Count Over Time", x = "Time", y = "Population Count") +
  theme_minimal()
T2MPlotAlBe<- ggplot(SWD_dataAlBe, aes(x=YYYYMMDD, y=T2M)) +
  geom_line(color = "lightblue") +
  labs(title = "AlBe Temperature Over Time", x = "Time", y = "Temperature (C)") +
  theme_minimal()
# Stack plots vertically using patchwork
grid.arrange(SWDPlotAlBe, T2MPlotAlBe, nrow = 2)

#FrSa
SWDPlotFrSa<-ggplot(data = SWD_dataFrSa, aes(x = YYYYMMDD, y = N_swd)) +
  geom_point(color = "orange", size = 1.5, shape =16, alpha = 0.7) +
  labs(title = "FrSa SWD Count Over Time", x = "Time", y = "Population Count") +
  theme_minimal()
T2MPlotFrSa <- ggplot(SWD_dataFrSa, aes(x=YYYYMMDD, y=T2M)) +
  geom_line(color = "lightblue") +
  labs(title = "FrSa Temperature Over Time", x = "Time", y = "Temperature (C)") +
  theme_minimal()
# Stack plots vertically using patchwork
grid.arrange(SWDPlotFrSa, T2MPlotFrSa, nrow = 2)

```


```{r}
#create interpolated data for full dataset
swd_interpolated<-approx(y = AbundanceTempTotal$N_swd, x = AbundanceTempTotal$T2M, method = "linear", n = 50,
          rule = 1, f = 0, ties = mean, na.rm = TRUE)
#create interpolated data for VT flies
swd_interpolatedVT<-approx(y = AbundanceTempVT$N_swd, x = AbundanceTempVT$T2M, method = "linear", n = 50,
          rule = 1, f = 0, ties = mean, na.rm = TRUE)
#create interpolated data for VA flies
swd_interpolatedVA<-approx(y = AbundanceTempVA$N_swd, x = AbundanceTempVA$T2M, method = "linear", n = 50,
          rule = 1, f = 0, ties = mean, na.rm = TRUE)
#create interpolated data for KY flies
swd_interpolatedKY<-approx(y = AbundanceTempKY$N_swd, x = AbundanceTempKY$T2M, method = "linear", n = 50,
          rule = 1, f = 0, ties = mean, na.rm = TRUE)

#TESTING create interpolated data for FBF flies
swd_interpolatedFBF<-approx(y = SWD_dataFBF$N_swd, x = SWD_dataFBF$T2M, method = "linear", n = 50,
          rule = 1, f = 0, ties = mean, na.rm = TRUE)
# create interpolated data for ABF flies
swd_interpolatedABF<-approx(y = SWD_dataABF$N_swd, x = SWD_dataABF$T2M, method = "linear", n = 50,
          rule = 1, f = 0, ties = mean, na.rm = TRUE)
# create interpolated data for CM flies
swd_interpolatedCM<-approx(y = SWD_dataCM$N_swd, x = SWD_dataCM$T2M, method = "linear", n = 50,
          rule = 1, f = 0, ties = mean, na.rm = TRUE)
# create interpolated data for LBA flies
swd_interpolatedLBA<-approx(y = SWD_dataLBA$N_swd, x = SWD_dataLBA$T2M, method = "linear", n = 50,
          rule = 1, f = 0, ties = mean, na.rm = TRUE)
# create interpolated data for AlBe flies
swd_interpolatedAlBe<-approx(y = SWD_dataAlBe$N_swd, x = SWD_dataAlBe$T2M, method = "linear", n = 50,
          rule = 1, f = 0, ties = mean, na.rm = TRUE)
# create interpolated data for FrSa flies
swd_interpolatedFrSa<-approx(y = SWD_dataFrSa$N_swd, x = SWD_dataFrSa$T2M, method = "linear", n = 50,
          rule = 1, f = 0, ties = mean, na.rm = TRUE)
```

```{r}
#create a cross correlation for SWD pop over time for FrSa
ccf(swd_interpolatedFrSa[["x"]],swd_interpolatedFrSa[["y"]], lag.max = NULL, type = c("correlation", "covariance"),
    plot = TRUE, na.action = na.fail,
    main = "FrSa Population & Temperature cross-correlation")

#create a cross correlation for SWD pop over time for Albe
ccf(swd_interpolatedAlBe[["x"]],swd_interpolatedAlBe[["y"]],ylim = c(-0.5, .5), lag.max = NULL, type = c("correlation", "covariance"),
    plot = TRUE, na.action = na.fail,
    main = "AlBe Population & Temperature cross-correlation")

#create a cross correlation for SWD pop over time for LBA
ccf(swd_interpolatedLBA[["x"]],swd_interpolatedLBA[["y"]],ylim = c(-0.5, .5), lag.max = NULL, type = c("correlation", "covariance"),
    plot = TRUE, na.action = na.fail,
    main = "LBA SWD Population & Temperature cross-correlation")

#create a cross correlation for SWD pop over time for CM
ccf(swd_interpolatedCM[["x"]],swd_interpolatedCM[["y"]],ylim = c(-0.5, .5), lag.max = NULL, type = c("correlation", "covariance"),
    plot = TRUE, na.action = na.fail,
    main = "CM SWD Population & Temperature cross-correlation")

#create a cross correlation for SWD pop over time for ABF data
ccf(swd_interpolatedABF[["x"]],swd_interpolatedABF[["y"]], ylim = c(-0.5, .5),lag.max = NULL, type = c("correlation", "covariance"),
    plot = TRUE, na.action = na.fail,
    main = "ABF SWD Population & Temperature cross-correlation")

#TESTING create a cross correlation for SWD pop over time for Full Belly data
ccf(swd_interpolatedFBF[["x"]],swd_interpolatedFBF[["y"]], ylim = c(-0.5, .5), lag.max = NULL, type = c("correlation", "covariance"),
    plot = TRUE, na.action = na.fail,
    main = "FBF SWD Population & Temperature cross-correlation")
```

```{r}
# If X was temp and Y was Drosh
cor(SWD_dataABF$T2M[1:18],SWD_dataABF$N_swd[11:28]) #lag of +10 (temp today vs. Dros in 10 days)

#this method is easier for me to work out
ABFcor<-cor(SWD_dataABF$N_swd, lag(SWD_dataABF$T2M, 10), use = "complete.obs")
FBFcor<-cor(SWD_dataFBF$N_swd, lag(SWD_dataFBF$T2M, 10), use = "complete.obs")
LBAcor<-cor(SWD_dataLBA$N_swd, lag(SWD_dataLBA$T2M, 10), use = "complete.obs")
CMcor<-cor(SWD_dataCM$N_swd, lag(SWD_dataCM$T2M, 10), use = "complete.obs")
FrSacor<-cor(SWD_dataFrSa$N_swd, lag(SWD_dataFrSa$T2M, 10), use = "complete.obs")
AlBecor<-cor(SWD_dataAlBe$N_swd, lag(SWD_dataAlBe$T2M, 10), use = "complete.obs")
```

more code im not using. this one is to make temp and swd on one plot 
coeff<-10
ggplot(SWD_dataFBF, aes(x=YYYYMMDD)) +
  geom_line( aes(y=N_swd), size=1, color="orange") + 
  geom_line( aes(y=T2M*15), size=1, color="lightblue") +
  scale_y_continuous(
    # Features of the first axis
    name = "SWD count",
    # Add a second axis and specify its features
    sec.axis = sec_axis(~./15, name="Temperature")
  ) + 
  theme(
    axis.title.y = element_text(color = "orange", size=13),
    axis.title.y.right = element_text(color = "lightblue", size=13)
  ) +
  ggtitle("FBF SWD count and temperature over time")
#ADAM'S BERRY FARM
ggplot(SWD_dataABF, aes(x=YYYYMMDD)) +
  geom_line( aes(y=N_swd), size=1, color="sienna") + 
  geom_line( aes(y=T2M*3), size=1, color="slategray1") +
  scale_y_continuous(
    # Features of the first axis
    name = "SWD count",
    # Add a second axis and specify its features
    sec.axis = sec_axis(~./3, name="Temperature")
  ) + 
  theme(
    axis.title.y = element_text(color = "sienna", size=13),
    axis.title.y.right = element_text(color = "slategray1", size=13)
  ) +
  ggtitle("ABF SWD count and temperature over time")
#CM
ggplot(SWD_dataCM, aes(x=YYYYMMDD)) +
  geom_line( aes(y=N_swd), size=1, color="salmon1") + 
  geom_line( aes(y=T2M*5), size=1, color="lightskyblue") +
  scale_y_continuous(
    # Features of the first axis
    name = "SWD count",
    # Add a second axis and specify its features
    sec.axis = sec_axis(~./5, name="Temperature")
  ) + 
  theme(
    axis.title.y = element_text(color = "salmon1", size=13),
    axis.title.y.right = element_text(color = "lightskyblue", size=13)
  ) +
  ggtitle("CM SWD count and temperature over time")
#LBA
ggplot(SWD_dataLBA, aes(x=YYYYMMDD)) +
  geom_line( aes(y=N_swd), size=1, color="tomato") + 
  geom_line( aes(y=T2M*50), size=1, color="mediumturquoise") +
  scale_y_continuous(
    # Features of the first axis
    name = "SWD count",
    # Add a second axis and specify its features
    sec.axis = sec_axis(~./50, name="Temperature")
  ) + 
  theme(
    axis.title.y = element_text(color = "tomato", size=13),
    axis.title.y.right = element_text(color = "mediumturquoise", size=13)
  ) +
  ggtitle("LBA SWD count and temperature over time")
#AlBe
ggplot(SWD_dataAlBe, aes(x=YYYYMMDD)) +
  geom_line( aes(y=N_swd), size=1, color="lightsalmon") + 
  geom_line( aes(y=T2M*10), size=1, color="royalblue1") +
  scale_y_continuous(
    # Features of the first axis
    name = "SWD count",
    # Add a second axis and specify its features
    sec.axis = sec_axis(~./10, name="Temperature",)
  ) + 
  theme(
    axis.title.y = element_text(color = "lightsalmon", size=13),
    axis.title.y.right = element_text(color = "royalblue1", size=13)
  ) +
  ggtitle("AlBe SWD count and temperature over time")
#FrSa
ggplot(SWD_dataFrSa, aes(x=YYYYMMDD)) +
  geom_line( aes(y=N_swd), size=1, color="chocolate1") + 
  geom_line( aes(y=T2M), size=1, color="cadetblue") +
  scale_y_continuous(
    # Features of the first axis
    name = "SWD count",
    # Add a second axis and specify its features
    sec.axis = sec_axis(~.*1, name="Temperature")
  ) + 
  theme(
    axis.title.y = element_text(color = "chocolate1", size=13),
    axis.title.y.right = element_text(color = "cadetblue", size=13)
  ) +
  ggtitle("FrSa SWD count and temperature over time")
```

THIS IS STUFF I TRIED AND NO LONGER AM USING BUT AM KEEPING JUST IN CASE <3
#create a plot of temp and count for fbf
ggplot(SWD_dataFBF, aes(x = YYYYMMDD)) +
  geom_line(aes(y = N_swd/10), color = "lightblue") + # Primary line
  geom_line(aes(y = T2M), color = "orange") + # Secondary line with scaled data
  scale_y_continuous(
    name = "N_swd",
    sec.axis = sec_axis(~ . * coeff, name = "Temperature") # Inverse transformation for secondary axis labels
  ) +
  theme_minimal()


library(latticeExtra)
#trying more of this because I cant figure it out
plot(YYYYMMDD, N_swd, pch=16, axes=FALSE, ylim=c(0,3500), xlab="", ylab="", 
   type="b",col="sienna", main="Mike's test data")
axis(2, ylim=c(0,1),col="sienna",las=1)  ## las=1 makes horizontal labels
mtext("N_swd",side=2,line=3)
box()

## Allow a second plot on the same graph
par(new=TRUE)

## Plot the second plot and put axis scale on right
plot(YYYYMMDD, T2M, pch=15,  xlab="", ylab="", ylim=c(0,60), 
    axes=FALSE, type="b", col="royalblue")
## a little farther out (line=4) to make room for labels
mtext("Temperature",side=4,col="royalblue",line=3) 
axis(4, ylim=c(0,7000), col="royalblue",col.axis="royalblue",las=1)

## Draw the time axis
axis(1,pretty(range(YYYYMMDD),10))
mtext("Time",side=1,col="sienna",line=2.5)  

## Add Legend
legend("topleft",legend=c("N_swd","T2M"),
  text.col=c("sienna","royalblue"),pch=c(16,15),col=c("sienna","royalblue"))




#create a plot of t2m and n_swd for all swd data 
par(mar = c(5, 4, 4, 4) + 0.3)              # Additional space for second y-axis
plot(YYYYMMDD, N_swd, pch = 20, col = 2)   # Create first plot
par(new = TRUE)                             # Add new plot
plot(YYYYMMDD,T2M, pch = 20, col = 3,              # Create second plot without axes
     axes = FALSE, xlab = "", ylab = "")
axis(side = 4, at = pretty(range(T2M)))      # Add second axis
mtext("Temperature", side = 4, line = 3) # Add second axis label


#create a plot of t2m and n_swd for all fbf swd data
par(mar = c(5, 4, 4, 4) + 0.3)              # Additional space for second y-axis
plot(SWD_dataFBF$YYYYMMDD, SWD_dataFBF$N_swd, pch = 16, col = 2)              # Create first plot
par(new = TRUE)                             # Add new plot
plot(SWD_dataFBF$YYYYMMDD,SWD_dataFBF$T2M, pch = 17, col = 3,              # Create second plot without axes
     axes = FALSE, xlab = "", ylab = "SWD Count")
axis(side = 4, at = pretty(range(T2M)))      # Add second axis
mtext("Temperature", side = 4, line = 3)              # Add second axis label
